# 08b. 테스트 시나리오 (Test Scenarios)

← [목차로 돌아가기](../sdd-specification.md) | [08. 테스트 명세](08-test-specs.md)

> 각 테스트 ID의 SPEC 매핑 및 테스트 계층은 [08-test-specs.md](08-test-specs.md)를 참조하세요.
> 이 문서는 각 케이스의 **구체적인 실행 절차 및 입력값**을 정의합니다.

---

## 프론트엔드 단위/컴포넌트 테스트

### FE-LOGIN-001 닉네임 유효성 실패

- **조건:** 입력값 `"a"` (1자)
- **시나리오:**
  1. 로그인 화면 진입
  2. 닉네임에 1자 입력
  3. 채팅 시작 버튼 클릭
- **기대 결과:** 오류 메시지 `"닉네임은 2자 이상이어야 합니다."` 표시
- **검증 포인트:** 오류 메시지 렌더링 / `onLoginSuccess` 미호출

---

### FE-LOGIN-002 닉네임 로그인 성공

- **조건:** 입력값 `"tester"` / 서버 응답: 사용자 객체
- **시나리오:**
  1. 닉네임 `"tester"` 입력
  2. 채팅 시작 버튼 클릭
- **기대 결과:** `chatUser`가 localStorage에 저장 / `onLoginSuccess` 호출
- **검증 포인트:** localStorage 값 / 콜백 호출 파라미터

---

### FE-ROOM-001 채팅방 생성 성공

- **조건:** 이름 `"QA Room"`, 설명 `"sample"`
- **시나리오:**
  1. 채팅방 생성 모달 오픈
  2. 이름/설명 입력 후 생성 버튼 클릭
- **기대 결과:** `onChatRoomCreated` 호출 / 모달 닫힘
- **검증 포인트:** API 호출 파라미터 / 콜백 호출 여부

---

### FE-ROOM-002 채팅방 목록 로딩 실패

- **조건:** 목록 API 오류 (500)
- **시나리오:**
  1. 채팅방 목록 화면 진입
- **기대 결과:** 오류 안내 및 재시도 버튼 표시
- **검증 포인트:** 오류 메시지 렌더링 / 재시도 버튼 존재

---

### FE-SEARCH-001 메시지 검색 성공

- **조건:** 채팅방에 메시지 2개 이상 존재 / 검색어 `"hello"` 포함 메시지 1개 이상
- **시나리오:**
  1. 검색 입력 필드에 `"hello"` 입력
  2. 검색 버튼 클릭 또는 엔터 입력
  3. 검색 결과 표시 대기
- **기대 결과:** `"hello"` 포함 메시지 목록 표시 / 최신순 정렬 / 발신자·내용·시간 표시
- **검증 포인트:** 결과 메시지 개수 / 내용 일치 / 정렬 순서

---

### FE-SEARCH-002 메시지 검색 결과 없음

- **조건:** 검색어 `"nonexistent"` / 해당 내용 메시지 없음
- **시나리오:**
  1. 검색 입력 필드에 `"nonexistent"` 입력
  2. 검색 실행
- **기대 결과:** `"검색 결과가 없습니다."` 메시지 표시
- **검증 포인트:** 안내 메시지 렌더링

---

### FE-SEARCH-003 빈 검색어 입력

- **조건:** 검색 입력 필드 비어있음
- **시나리오:**
  1. 검색 입력 필드 비워둔 상태에서 검색 버튼 클릭 또는 엔터
- **기대 결과:** 검색 미실행 / `"검색어를 입력해주세요."` 안내 표시
- **검증 포인트:** 검색 API 미호출 / 안내 메시지 렌더링

---

### FE-SEARCH-004 메시지 검색 API 오류 처리

- **조건:** 검색 API 서버 오류 (500)
- **시나리오:**
  1. 검색 실행
- **기대 결과:** 오류 메시지 표시 / 검색 입력 필드 활성 상태 유지
- **검증 포인트:** 오류 메시지 렌더링 / 재시도 가능 상태

---

## 백엔드 단위 테스트

### BE-DOMAIN-001 닉네임 중복 검증

- **조건:** `existsByNickname` = true
- **시나리오:**
  1. 도메인 서비스 `createUser` 호출
- **기대 결과:** `IllegalArgumentException` 발생
- **검증 포인트:** 예외 메시지

---

### BE-API-HEALTH-001 헬스 체크

- **조건:** 서버 정상 구동
- **시나리오:**
  1. `GET /api/health` 호출
- **기대 결과:** `status=OK`, `message=Server is running`
- **검증 포인트:** HTTP 200 / JSON 필드 값

---

### BE-SEARCH-001 키워드로 메시지 검색

- **조건:** Testcontainers MySQL / 채팅방에 메시지 3개 저장 (`"hello world"`, `"goodbye"`, `"hello everyone"`) / 검색 키워드 `"hello"`
- **시나리오:**
  1. `MessageRepository.searchByChatRoomIdAndKeyword(roomId, "hello")` 호출
- **기대 결과:** 메시지 2개 반환 (`"hello world"`, `"hello everyone"`) / 전송 시간 역순 정렬
- **검증 포인트:** 반환 메시지 크기 / 내용 / 정렬 순서

---

### BE-SEARCH-002 대소문자 구분 없는 검색

- **조건:** 메시지 내용 `"Hello World"` / 검색 키워드 `"hello"`
- **시나리오:**
  1. `MessageRepository.searchByChatRoomIdAndKeyword(roomId, "hello")` 호출
- **기대 결과:** 해당 메시지 반환
- **검증 포인트:** 대소문자 무관 검색 결과 반환

---

### BE-SEARCH-003 특수문자를 포함한 검색

- **조건:** 메시지 내용 `"price: $100"` / 검색 키워드 `"$100"`
- **시나리오:**
  1. `MessageRepository.searchByChatRoomIdAndKeyword(roomId, "$100")` 호출
- **기대 결과:** 해당 메시지 반환
- **검증 포인트:** 특수문자 포함 검색 결과 반환

---

### BE-SEARCH-004 빈 검색 키워드

- **조건:** 검색 키워드 `""`
- **시나리오:**
  1. `MessageRepository.searchByChatRoomIdAndKeyword(roomId, "")` 호출
- **기대 결과:** 전체 메시지 반환 또는 빈 리스트 (구현 정책에 따름)
- **검증 포인트:** 예외 미발생 / 결과 일관성

---

## 백엔드 통합 테스트

### BE-INT-USER-001 사용자 저장/조회

- **조건:** Testcontainers MySQL 사용
- **시나리오:**
  1. 사용자 저장
  2. 닉네임으로 조회
- **기대 결과:** 저장된 사용자 반환
- **검증 포인트:** ID 생성 확인 / 닉네임 일치

---

### BE-API-SEARCH-001 메시지 검색 엔드포인트

- **조건:** 서버 정상 구동 / 채팅방 ID: 1 / 검색 키워드: `"test"`
- **시나리오:**
  1. `GET /api/chat-rooms/1/messages/search?keyword=test` 호출
- **기대 결과:** HTTP 200 / 검색 결과 메시지 목록 JSON 반환
- **검증 포인트:** HTTP 상태 코드 / 응답 형식

---

## E2E 테스트

### E2E-CHAT-001 로그인 후 채팅방 생성 및 메시지 전송

- **조건:** 프론트/백엔드 실행
- **시나리오:**
  1. 닉네임 입력 및 로그인
  2. 채팅방 생성
  3. WebSocket 연결 확인
  4. 메시지 전송
- **기대 결과:** 채팅방 헤더 표시 / 연결됨 상태 표시 / 메시지 렌더링
- **검증 포인트:** 화면 요소 존재 / 메시지 텍스트 확인

---

### E2E-CHAT-002 기존 채팅방 입장 및 시스템 메시지 확인

- **조건:** 프론트/백엔드 실행 / 기존 채팅방이 생성되어 있어야 함 / 닉네임은 허용 형식(영문/숫자/한글/언더스코어)
- **시나리오:**
  1. 로그인 화면에서 닉네임 입력 및 로그인
  2. 채팅방 목록에서 기존 채팅방 입장
  3. 시스템 메시지 `"~님이 입장했습니다."` 표시 확인
  4. 메시지 전송
- **기대 결과:** 헤더 표시 / 시스템 메시지 렌더링 / 전송 메시지 표시 / 기존 미읽음 카운트 유지
- **검증 포인트:** 채팅방 헤더 요소 / 시스템 메시지 텍스트 / 메시지 텍스트 / 미읽음 카운트 유지

---

### E2E-CHAT-003 미읽음 카운트 표시

- **조건:** 채팅방 생성 후 사용자 B(활성 멤버)가 참여한 상태 / 사용자 B는 UI 미접속(메시지 미읽음)
- **시나리오:**
  1. 사용자 A 로그인 후 채팅방 입장
  2. 사용자 B는 API로만 채팅방 참여(UI 미접속)
  3. 사용자 A가 메시지 전송
- **기대 결과:** 사용자 A의 메시지에 미읽음 카운트 표시 (예: `"1"`)
- **검증 포인트:** 미읽음 카운트 텍스트 렌더링

---

### E2E-CHAT-004 읽음 처리 후 미읽음 카운트 변화

- **조건:** 채팅방에 참가자 2명 또는 3명 이상
- **시나리오:**
  1. 사용자 A가 메시지 전송
  2. 사용자 B가 읽음 처리 수행
- **기대 결과:**
  - 참가자 2명: 미읽음 카운트 `0`으로 사라짐
  - 참가자 3명 이상: 미읽음 카운트 1 감소
- **검증 포인트:** 2명 - 카운트 사라짐 / 3명 이상 - 숫자 1 감소

---

### E2E-SEARCH-001 채팅방 메시지 검색 및 결과 표시

- **조건:** 프론트/백엔드 실행 / 채팅방에 메시지 4개 전송 (`"apple"`, `"banana"`, `"apple pie"`, `"peach"`)
- **시나리오:**
  1. 검색 버튼(`aria-label="메시지 검색"`) 클릭
  2. 검색 입력 필드(`placeholder="검색..."`)에 `"apple"` 입력
  3. Enter 제출
  4. 검색 결과 대기
- **기대 결과:** 결과 2건 이상 표시 / 채팅창 메시지에 `mark.bg-yellow-200` 하이라이트 렌더링
- **검증 포인트:** `N건` 텍스트 표시 / 하이라이트 요소 2개 이상 존재

---

### E2E-SEARCH-002 검색 결과 없음

- **조건:** 프론트/백엔드 실행 / 채팅방에 메시지 `"hello world"` 1개 존재
- **시나리오:**
  1. 검색 버튼 클릭
  2. 검색 입력 필드에 `"nonexistent"` 입력
  3. Enter 제출
- **기대 결과:** `"검색 결과 없음"` 텍스트 표시
- **검증 포인트:** 안내 문구 렌더링

---

### E2E-SEARCH-003 빈 검색어 제출 (발신자 필터 미선택)

- **조건:** 프론트/백엔드 실행 / 채팅방 입장 상태 / 발신자 필터 선택 없음
- **시나리오:**
  1. 검색 버튼 클릭
  2. 발신자 필터를 선택하지 않은 상태에서 검색 입력 필드를 비워두고 Enter 제출
- **기대 결과:** `"검색어를 입력해주세요."` 오류 메시지 표시 / 검색 API 미호출
- **검증 포인트:** 오류 메시지 렌더링 / 네트워크 요청 미발생

---

### E2E-LOGIN-VALIDATION 닉네임 유효성 실패 (1자)

- **조건:** 프론트 실행 / 로그인 화면
- **시나리오:**
  1. 닉네임 입력 필드에 `"a"` (1자) 입력
  2. `POST /api/users` 호출 여부 모니터링
  3. 채팅 시작 버튼 클릭
- **기대 결과:** `"닉네임은 2자 이상이어야 합니다."` 오류 메시지 표시 / API 미호출 / `/login` URL 유지
- **검증 포인트:** 오류 메시지 텍스트 / `apiCalled === false` / URL 패턴

---

### E2E-ROOM-002-VALIDATION 채팅방 이름 1자 입력 시 생성 버튼 비활성화

- **조건:** 프론트/백엔드 실행 / 로그인 후 채팅방 목록 화면
- **시나리오:**
  1. 새 채팅방 만들기 버튼 클릭
  2. 채팅방 이름 입력 필드에 `"a"` (1자) 입력
- **기대 결과:** 생성 버튼이 `disabled` 상태
- **검증 포인트:** 버튼 `disabled` 속성 확인

---

### E2E-ROOM-004 채팅방 퇴장 후 목록 복귀

- **조건:** 프론트/백엔드 실행 / 채팅방 생성 및 입장 상태
- **시나리오:**
  1. 햄버거 메뉴(`aria-label="참여자 목록"`) 클릭
  2. 사이드바에서 `"채팅방 나가기"` 버튼 클릭
  3. 모달 팝업에서 `"나가기"` 버튼 클릭
- **기대 결과:** 채팅방 목록 화면으로 복귀 / "새 채팅방 만들기" 버튼 표시
- **검증 포인트:** 목록 화면 요소 존재

---

### E2E-ROOM-004-CANCEL 채팅방 나가기 모달 취소

- **조건:** 프론트/백엔드 실행 / 채팅방 입장 상태
- **시나리오:**
  1. 햄버거 메뉴(`aria-label="참여자 목록"`) 클릭
  2. 사이드바에서 `"채팅방 나가기"` 버튼 클릭
  3. 모달 팝업에서 `"취소"` 버튼 클릭
- **기대 결과:** 모달이 닫히고 채팅방 화면 유지
- **검증 포인트:** 채팅방 메시지 입력창 표시 / 목록 화면으로 이동하지 않음

---

### E2E-ROOM-HEADER-001 채팅방 상세 헤더 - 채팅방 목록 버튼 및 아바타 그룹 표시

- **조건:** 프론트/백엔드 실행 / 채팅방 생성 및 입장 상태
- **시나리오:**
  1. 채팅방 생성 후 채팅방 상세 화면 진입
  2. 헤더 왼쪽 버튼 확인
  3. 헤더 중앙 영역 확인
- **기대 결과:**
  - 헤더 왼쪽에 `"채팅방 목록"` 텍스트가 있는 뒤로가기 버튼 표시
  - 헤더 중앙에 채팅방 이름, 참여자 수(숫자) 표시
  - 본인 외 활성 멤버가 있으면 아바타 그룹 표시 (멤버 수에 따라 1~4개)
  - 뒤로가기 버튼 클릭 시 채팅방 목록으로 이동
- **검증 포인트:** `"채팅방 목록"` 텍스트 요소 존재 / 참여자 수 숫자 렌더링 / 채팅방 목록 화면 복귀

---

### BE-ROOM-006 채팅방 목록 아바타 그룹 - 본인 항상 제외 및 nickname 포함

- **조건:** 채팅방에 본인(userA) + 다른 활성 멤버(userB, userC) 3명 (active=true)
- **시나리오:**
  1. `buildRoomResponse(chatRoom, userA.getId(), ...)` 호출
- **기대 결과:** 반환된 `memberAvatars` 목록에 userB, userC 2개의 아바타만 포함 (userA 제외), 각 아바타에 `nickname` 필드 존재
- **검증 포인트:** `memberAvatars.size() == 2` / userA 미포함 / 각 아바타의 `nickname` != null

---

### BE-ROOM-007 채팅방 목록 아바타 그룹 - 단독 참여 시 빈 목록

- **조건:** 채팅방에 본인(userA)만 활성 상태 (active=true)
- **시나리오:**
  1. `buildRoomResponse(chatRoom, userA.getId(), ...)` 호출
- **기대 결과:** 반환된 `memberAvatars`가 빈 리스트
- **검증 포인트:** `memberAvatars.isEmpty() == true`

---

### BE-ROOM-008 채팅방 목록 아바타 그룹 - 퇴장 멤버 제외

- **조건:** 채팅방에 userA(active=true), userB(active=true), userC(active=false, 퇴장)
- **시나리오:**
  1. `buildRoomResponse(chatRoom, userA.getId(), ...)` 호출
- **기대 결과:** 반환된 `memberAvatars`에 userB만 포함 (userC 제외)
- **검증 포인트:** `memberAvatars.size() == 1` / userC 미포함

---

### E2E-AVATAR-COUNT-001 채팅방 목록 아바타 그룹 개수 정확성 검증

- **조건:** 프론트/백엔드 실행 / 채팅방에 본인(A) 포함 총 4명 참여 상태
- **시나리오:**
  1. userA 로그인
  2. 채팅방 생성 (userA 방장)
  3. API로 userB, userC, userD 추가 입장
  4. 채팅방 목록 화면에서 해당 채팅방 항목의 아바타 그룹 확인
- **기대 결과:** 본인(userA) 제외 3명 → 삼각형 배치 3개 아바타 표시
- **검증 포인트:** 아바타 그룹 컨테이너 내 원형 아바타 요소 3개

---

### E2E-AVATAR-INITIAL-001 아바타 닉네임 첫 글자 표시 검증

- **조건:** 프론트/백엔드 실행 / 채팅방에 프로필 이미지 없는 멤버 존재
- **시나리오:**
  1. 닉네임 `"테스터A"` 로 로그인 (프로필 이미지 미첨부)
  2. 채팅방 생성 후 API로 닉네임 `"Beta"` 유저 추가 입장
  3. 채팅방 목록에서 해당 채팅방 확인 → 아바타 텍스트 확인
  4. 채팅방 입장 후 헤더 아바타 텍스트 확인
- **기대 결과:**
  - 채팅방 목록: 아바타에 `"B"` 텍스트 표시 (Beta의 첫 글자 대문자)
  - 채팅방 헤더: 아바타에 `"B"` 텍스트 표시
- **검증 포인트:** `page.locator` 로 아바타 span 내 `"B"` 텍스트 존재 확인

---

### E2E-ROOM-SIDEBAR-SORT-001 사이드바 참여자 목록 정렬

- **조건:** 프론트/백엔드 실행 / 채팅방에 여러 참여자 존재 (닉네임: "나", "Alice", "가나다", "123")
- **시나리오:**
  1. 채팅방 상세 화면에서 햄버거 메뉴 클릭
  2. 사이드바 참여자 목록 확인
- **기대 결과:**
  - 본인(나)이 목록 최상단에 `"(나)"` 레이블과 함께 표시
  - 나머지 참여자는 닉네임 사전순(숫자→영어→한글) 정렬: "123" → "Alice" → "가나다"
- **검증 포인트:** 첫 번째 항목에 `"(나)"` 텍스트 존재 / 정렬 순서 확인

---

### E2E-STICKER-001 스티커 전송 및 채팅창 렌더링

- **조건:** 프론트/백엔드 실행 / 채팅방 생성 및 WebSocket 연결 상태
- **시나리오:**
  1. 스티커 버튼(`aria-label="스티커"`) 클릭
  2. `"스티커 선택"` 모달 표시 확인
  3. 이모지 스티커 팩에서 `"😍"` 선택
- **기대 결과:** 모달 닫힘 / 채팅창에 `"😍"` 스티커 렌더링
- **검증 포인트:** 모달 미표시 / 스티커 이모지 텍스트 존재

---

### E2E-MSG-004 공백 메시지 전송 불가

- **조건:** 프론트/백엔드 실행 / 채팅방 WebSocket 연결 상태
- **시나리오:**
  1. 메시지 입력 필드에 `"   "` (공백 3칸) 입력
- **기대 결과:** 전송 버튼이 `disabled` 상태
- **검증 포인트:** 버튼 `disabled` 속성 확인

---

### E2E-MSG-LAYOUT 내 메시지 우측 정렬

- **조건:** 프론트/백엔드 실행 / 기존 채팅방에 입장 / 현재 로그인 사용자가 메시지 전송
- **시나리오:**
  1. 메시지 전송
  2. 메시지 컨테이너 DOM 확인
- **기대 결과:** 내 메시지를 감싸는 `div`에 `justify-end` 클래스 존재 (우측 정렬)
- **검증 포인트:** XPath ancestor 탐색으로 `justify-end` 클래스 확인

---

### E2E-IMG-001 유효한 이미지 업로드 후 채팅창 렌더링

- **조건:** 프론트/백엔드 실행 / 채팅방 WebSocket 연결 상태
- **시나리오:**
  1. `input[type="file"]`에 최소 크기 1×1 PNG 파일 설정 (mimeType: `image/png`)
- **기대 결과:** 서버 업로드 완료 후 채팅창에 `img[alt="사용자가 전송한 이미지"]` 태그 렌더링
- **검증 포인트:** 이미지 요소 `toBeVisible` 확인 (timeout 15초)

---

### E2E-IMG-002 5MB 초과 파일 업로드 시 경고

- **조건:** 프론트 실행 / 채팅방 WebSocket 연결 상태
- **시나리오:**
  1. `window.alert`를 스파이 함수로 교체 (메시지 캡처)
  2. `input[type="file"]`에 5MB+1 바이트 파일 설정 (mimeType: `image/png`)
  3. `window._capturedAlert` 값 확인
- **기대 결과:** `"5MB"` 포함 경고 메시지 / 채팅창에 이미지 미추가
- **검증 포인트:** `alertMsg.includes('5MB')` / `img` 요소 개수 0

---

### E2E-IMG-003 지원하지 않는 파일 형식 업로드 시 경고

- **조건:** 프론트 실행 / 채팅방 WebSocket 연결 상태
- **시나리오:**
  1. `window.alert`를 스파이 함수로 교체 (메시지 캡처)
  2. `input[type="file"]`에 PDF 파일 설정 (mimeType: `application/pdf`)
  3. `window._capturedAlert` 값 확인
- **기대 결과:** `"JPG, PNG, GIF"` 포함 경고 메시지 / 채팅창에 이미지 미추가
- **검증 포인트:** `alertMsg.includes('JPG, PNG, GIF')` / `img` 요소 개수 0

---

### E2E-SEARCH-004 시스템 메시지는 검색 결과에 포함되지 않음

- **조건:** 채팅방 생성 직후 WebSocket 연결 상태 (SYSTEM 메시지 자동 생성됨)
- **시나리오:**
  1. 로그인 → 채팅방 생성 (`"채팅방을 생성했습니다."` SYSTEM 메시지 자동 생성)
  2. 검색 바 열기 → `"채팅방을 생성했습니다"` 입력 → Enter 제출
- **기대 결과:** `"검색 결과 없음"` 표시 (시스템 메시지는 `filteredResults`에서 제외)
- **검증 포인트:** `page.getByText('검색 결과 없음')` 표시

---

### E2E-SEARCH-005 참가자 필터링 시 해당 참가자의 메시지만 표시

- **조건:** user1(로그인), user2(API로 방 참여, 메시지 미전송)
- **시나리오:**
  1. user1이 `"hello world"` 전송
  2. `"hello"` 키워드 검색 → N건 결과 표시
  3. `"인물 검색"` 버튼 클릭 → user2 선택
  4. user2 필터 칩이 검색 바에 표시됨
  5. `"인물 필터 해제"` 클릭 → 전체 결과 복원
- **기대 결과:**
  - user2 선택 후: `"검색 결과 없음"` (user2는 hello 미전송)
  - 필터 해제 후: N건 결과 재표시
- **검증 포인트:**
  - user2 선택: `page.getByText('검색 결과 없음')` 표시
  - 필터 해제: `page.getByText(/\d+건/)` 재표시

---

### E2E-SEARCH-006 참가자와 키워드 복합 필터링 시 교집합 결과 표시

- **조건:** user1(로그인), user2(API로 방 참여, 메시지 미전송)
- **시나리오:**
  1. user1이 `"apple"`, `"banana"` 전송
  2. `"apple"` 검색 → 1건 결과 (user1)
  3. `"인물 검색"` → user1 선택 → 여전히 1건 (user1이 apple 전송)
  4. `"인물 검색"` → user2로 전환 → 0건 (user2는 apple 미전송)
- **기대 결과:**
  - user1 선택: 결과 N건 유지
  - user2 선택: `"검색 결과 없음"` (키워드 AND 참가자 교집합 없음)
- **검증 포인트:**
  - user1 선택: `page.getByText(/\d+건/)` 표시
  - user2 선택: `page.getByText('검색 결과 없음')` 표시

---

### E2E-SEARCH-007 참가자 필터링 시 메시지 버블의 발신자 이름 하이라이팅

- **조건:** user1(로그인 브라우저), user2(별도 브라우저 컨텍스트로 메시지 전송)
- **시나리오:**
  1. user2가 별도 브라우저에서 채팅방 입장 후 `"hello from user2"` 전송
  2. user1이 채팅방 입장 → user2 메시지 확인
  3. `"hello"` 검색 → N건 결과
  4. `"인물 검색"` → user2 선택
  5. 메시지 버블 상단의 user2 이름 확인
- **기대 결과:** user2의 이름이 `<mark class="bg-yellow-200 ...">` 태그로 하이라이팅 렌더링
- **검증 포인트:** `page.locator('mark', { hasText: user2Nickname })` 표시

---

### E2E-SEARCH-008 키워드 없이 발신자 필터만으로 건수 표시 및 화살표 네비게이션

- **조건:** user1(로그인), user2(API로 방 참여, 메시지 미전송)
- **시나리오:**
  1. user1이 `"첫번째 메시지"`, `"두번째 메시지"` 전송
  2. 검색 바 열기 (키워드 입력 없음)
  3. `"인물 검색"` → user1 선택
  4. 결과 건수 및 화살표 버튼 상태 확인
  5. `"인물 검색"` → user2로 전환 (메시지 없음)
  6. 결과 없음 및 화살표 비활성화 확인
- **기대 결과:**
  - user1 선택 시: N건 표시, 화살표 버튼 활성화
  - user2 선택 시: `"검색 결과 없음"`, 화살표 버튼 비활성화(`disabled`)
- **검증 포인트:**
  - `page.getByText(/\d+건/)` 표시 (user1)
  - `page.getByRole('button', { name: '이전 검색 결과' })` not disabled (user1)
  - `page.getByText('검색 결과 없음')` 표시 (user2)
  - `page.getByRole('button', { name: '다음 검색 결과' })` disabled (user2)

---

### E2E-SEARCH-009 캘린더 날짜 선택 시 필터 초기화 및 날짜 세퍼레이터로 이동

- **조건:** 채팅방에 오늘 날짜의 메시지 존재, 키워드 검색 활성 상태
- **시나리오:**
  1. 메시지 `"캘린더 테스트"` 전송
  2. 검색 바에서 `"캘린더"` 키워드 검색 → N건 결과 표시
  3. `"날짜로 이동"` 버튼 클릭 → 캘린더 팝업 오픈
  4. 파란색(활성화) 날짜 버튼 클릭
- **기대 결과:**
  - 검색 결과 카운트(`N건`) 사라짐 (키워드·발신자 필터 초기화)
  - 캘린더 팝업 닫힘
  - 해당 날짜의 날짜 세퍼레이터(`rounded-full border`) 화면에 표시
  - 선택 날짜 도달 후 날짜 세퍼레이터에 `message-bounce` 애니메이션 적용(~620ms 후)
- **검증 포인트:**
  - `page.getByText(/\d+건/)` not visible (필터 초기화 확인)
  - `page.locator('div.rounded-full.border').filter({ hasText: /\d{4}년/ })` visible

---

### E2E-SEARCH-010 발신자 필터 선택 상태에서 검색어 제거 후 Enter → 발신자 단독 필터링 전환

- **조건:** 프론트/백엔드 실행 / 채팅방 입장 상태 / 발신자 필터 + 키워드 복합 검색 활성
- **시나리오:**
  1. user1 로그인 → 채팅방 생성 → `"안녕하세요"`, `"반갑습니다"` 메시지 전송
  2. 검색 바 열기 → `"안녕"` 키워드 검색 (1건 결과 표시)
  3. `"인물 검색"` 버튼 클릭 → user1 선택 → 복합 필터 결과 표시
  4. 검색어 입력 필드를 지우고 Enter 제출
- **기대 결과:**
  - `"검색어를 입력해주세요."` 오류 메시지가 표시되지 않음
  - 발신자 필터(user1 칩)는 그대로 유지됨
  - user1의 모든 메시지(`"안녕하세요"`, `"반갑습니다"`) 2건이 결과로 표시됨
- **검증 포인트:**
  - `page.getByText('검색어를 입력해주세요.')` not visible
  - `page.getByText(/\d+건/)` visible (user1의 메시지 건수)
  - user1 필터 칩 요소 visible

---

### E2E-SEARCH-011 검색 결과 이동 시 메시지 버블에 바운스 애니메이션 적용

- **조건:** 프론트/백엔드 실행 / 채팅방에 검색 결과 2건 이상 존재
- **시나리오:**
  1. 로그인 → 채팅방 생성 → `"테스트A"`, `"테스트B"` 메시지 전송
  2. 검색 바 열기 → `"테스트"` 키워드 검색 (2건 결과)
  3. 검색 결과 건수(`N건`) 표시 확인
  4. `"이전 검색 결과"` 화살표 버튼 클릭 → 다른 메시지로 이동
- **기대 결과:**
  - `ring-2 ring-yellow-300` 클래스가 메시지에 적용되지 않음 (노란 링 방식 제거)
  - 이동한 메시지 버블의 감싸는 `div`에 인라인 스타일로 `animationName: message-bounce` 또는 `message-bounce-alt` 적용
- **검증 포인트:**
  - `page.locator('.ring-2.ring-yellow-300')` 요소 없음 (count === 0)
  - 현재 포커스된 메시지 버블 `div`의 style 속성에 `message-bounce` 포함

---

## 작성 가이드

- 각 케이스는 **조건 → 시나리오 → 기대 결과 → 검증 포인트** 순서를 유지한다.
- 실패 메시지는 사용자 관점의 텍스트로 작성한다.
- E2E는 외부 의존성을 최소화하고, 테스트마다 고유한 테스트 데이터를 사용한다.
